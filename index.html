<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>play / pause</title>
  </head>
  <body>
    <webview id="wv" src="https://soundcloud.com/jonwayne"
             style="display:inline-flex; width:640px; height:480px"
             autosize="on"
             minwidth="576" minheight="432"
             plugins
             allowpopups
             disablewebsecurity
             preload="./node_modules/electron-safe-ipc/guest-bundle.js"
    ></webview>
    <div class="indicator"></div>
    <br>
    We are using node <script>document.write(process.versions.node)</script>,
    Chrome <script>document.write(process.versions.chrome)</script>,
    and Electron <script>document.write(process.versions.electron)</script>.

    <script>
      var webview = document.getElementById('wv');
      var indicator = document.querySelector('.indicator');
      var contents
      function onload(){
        webview = document.getElementById('wv');
        indicator = document.querySelector('.indicator');

        var loadstart = function() {
          indicator.innerText = 'loading...';
        };

        var loadstop = function() {
          indicator.innerText = '';
        };

        webview.addEventListener('did-start-loading', loadstart);
        webview.addEventListener('did-stop-loading', loadstop);

        webview.addEventListener('dom-ready', function(){
          webview.openDevTools();
        });

        webview.addEventListener('console-message', function(e){
          console.log(e)
        });

        webview.addEventListener('media-started-playing', function(e){
          console.log(e)
        });

        webview.addEventListener('media-paused', function(e){
          console.log(e)
        });
      };

      onload();
    </script>
    <script>
      require('electron').ipcRenderer.on('playpause', (event, message) => {
        console.log(message);
        webview.executeJavaScript('electronSafeIpc.send("fromRenderer", document.querySelectorAll("*"), "a2");')
        //webview.executeJavaScript("console.log(document.querySelectorAll('button.playControl')[0].className); document.querySelectorAll('button.playControl')[0].click()")
      });

      require("electron-safe-ipc/host-webview").on("fromRenderer", function (a, b) {
        console.log("fromRenderer received", a, b);
      });
    </script>
  </body>
</html>
